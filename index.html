<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://mcp.figma.com/mcp/html-to-design/capture.js"></script>
  <title>CTV Export — Working Prototype</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,400;0,600;0,700;1,400&display=swap');

    :root {
      --font: 'Adobe Clean', 'Source Sans 3', system-ui, sans-serif;
      --neutral:  #292929;
      --subdued:  #505050;
      --gray-25:  #FFFFFF;
      --gray-100: #E9E9E9;
      --gray-200: #D0D0D0;
      --gray-300: #B5B5B5;
      --gray-400: #9A9A9A;
      --gray-500: #7E7E7E;
      --gray-800: #2e2e2e;
      --blue:     #274dea;
      --blue-bg:  #eef1fd;
      --green:    #12805c;
      --red:      #d7373f;
      --red-bg:   #fde8e9;
      --orange:   #cb6f10;
      --layer1:   #f8f8f8;
      --shadow:   0px 2px 8px 0px rgba(0,0,0,0.16);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    .hidden { display: none !important; }

    body {
      background: #DCDCDC;
      font-family: var(--font);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 40px;
      gap: 40px;
    }

    .container {
      display: flex;
      gap: 40px;
      align-items: flex-start;
    }

    .option-wrapper {
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: center;
    }

    .option-label {
      font-size: 12px;
      font-weight: 600;
      color: var(--neutral);
      background: var(--gray-100);
      padding: 4px 12px;
      border-radius: 12px;
      text-transform: uppercase;
      letter-spacing: 0.8px;
    }

    /* ── Panel ── */
    .panel {
      background: var(--gray-25);
      border-radius: 8px;
      box-shadow: var(--shadow);
      width: 344px;
      padding: 24px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    /* ── Header ── */
    .panel-header h2 {
      font-size: 20px; font-weight: 700;
      color: var(--neutral); line-height: 24px;
      margin-bottom: 8px;
    }
    .panel-header p {
      font-size: 14px; color: var(--subdued);
      line-height: 1.45;
    }

    /* ── Asset info bar ── */
    .asset-info {
      display: flex; align-items: center;
      gap: 10px; font-size: 13px; color: var(--neutral);
    }
    .info-item { display: flex; align-items: center; gap: 4px; }
    .info-item svg { color: var(--gray-500); flex-shrink: 0; }
    .divider-v { width:1px; height:12px; background:var(--gray-200); flex-shrink:0; }

    /* ── Platform section ── */
    .platform-section {
      margin: 20px 0 12px 0;
      position: relative;
    }

    /* Fade gradient at bottom of list */
    .platform-section::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: linear-gradient(to bottom, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%);
      pointer-events: none;
    }

    /* ── Section label ── */
    .section-label {
      font-size: 14px; color: var(--subdued);
      display: flex; align-items: baseline; justify-content: space-between;
      padding-bottom: 6px;
    }
    .section-label .count {
      font-size: 14px; font-weight: 400; color: var(--neutral);
    }

    /* ── Platform accordion list ── */
    .platform-list {
      display: flex; flex-direction: column; gap: 6px;
      max-height: 290px; /* ~4.5 rows to ensure scroll shows */
      overflow-y: auto;
      overflow-x: hidden;
      padding-right: 4px;
      padding-bottom: 60px; /* Space for last item to scroll into view */
    }

    /* Custom scrollbar styling */
    .platform-list::-webkit-scrollbar {
      width: 8px;
    }

    .platform-list::-webkit-scrollbar-track {
      background: transparent;
      border-radius: 4px;
    }

    .platform-list::-webkit-scrollbar-thumb {
      background: var(--gray-400);
      border-radius: 4px;
    }

    .platform-list::-webkit-scrollbar-thumb:hover {
      background: var(--gray-500);
    }

    .platform-row {
      border: 2px solid #E9E9E9;
      border-radius: 8px;
      overflow: hidden;
      transition: border-color 0.12s, background 0.12s;
      background: white;
      flex-shrink: 0;
    }
    .platform-row:hover {
      background: #F8F8F8;
    }
    .platform-row.selected {
      border-color: var(--neutral);
      background: white;
    }

    .platform-row-header {
      display: flex; align-items: center;
      gap: 10px; padding: 9px 12px;
      cursor: pointer; user-select: none;
      height: 60px;
      min-height: 60px;
    }

    /* Checkbox */
    .platform-check {
      width: 18px; height: 18px;
      border-radius: 4px;
      border: 2px solid var(--gray-300);
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
      background: white;
      transition: background 0.1s, border-color 0.1s;
    }
    .platform-row.selected .platform-check {
      background: var(--neutral);
      border-color: var(--neutral);
    }
    .platform-check svg { display: none; }
    .platform-row.selected .platform-check svg { display: block; }

    /* Logo */
    .platform-logo {
      width: 40px; height: 40px;
      border-radius: 4px;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
      overflow: hidden;
    }
    .platform-logo img {
      width: 100%; height: 100%;
      object-fit: contain;
    }

    /* Name */
    .platform-name {
      flex: 1;
      font-size: 14px; font-weight: 400;
      color: var(--neutral);
    }

    /* Chevron — only visible when selected */
    .platform-chevron {
      flex-shrink: 0;
      color: var(--gray-500);
      transition: transform 0.18s, opacity 0.12s;
      opacity: 0;
      pointer-events: none;
    }
    .platform-row.selected .platform-chevron {
      opacity: 1;
      pointer-events: auto;
    }
    .platform-row.open .platform-chevron {
      transform: rotate(180deg);
    }

    /* Spec panel (expanded) */
    .platform-specs {
      display: none;
      border-top: 1px solid var(--gray-100);
      padding: 10px 12px 12px 12px;
      background: white;
    }
    .platform-row.open .platform-specs {
      display: block;
    }
    .spec-row {
      display: flex; justify-content: space-between;
      align-items: baseline;
      font-size: 12px;
      padding: 3px 0;
    }
    .spec-label { color: var(--subdued); }
    .spec-value { font-weight: 600; color: var(--neutral); text-align: right; }
    .spec-value.warning { color: var(--orange); }

    /* ── Custom Platform Pickers ── */
    .platform-specs--custom {
      padding: 16px 12px;
      flex-direction: column;
      gap: 12px;
    }

    .platform-row.open .platform-specs--custom {
      display: flex;
    }

    .custom-field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .custom-field__label {
      font-size: 12px;
      color: var(--subdued);
      font-weight: 400;
    }

    .custom-select {
      width: 100%;
      height: 32px;
      padding: 0 32px 0 10px;
      border: 1px solid var(--gray-300);
      border-radius: 4px;
      background: white;
      font-size: 13px;
      color: var(--neutral);
      font-family: 'Adobe Clean', 'Source Sans 3', system-ui, sans-serif;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg width='10' height='6' viewBox='0 0 10 6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L5 5L9 1' stroke='%23505050' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
      transition: border-color 0.13s;
    }

    .custom-select:hover {
      border-color: var(--gray-400);
    }

    .custom-select:focus {
      outline: none;
      border-color: var(--blue);
      box-shadow: 0 0 0 1px var(--blue);
    }

    .custom-recommended {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--blue);
      margin-top: 2px;
    }

    .custom-recommended svg {
      flex-shrink: 0;
    }

    .custom-field--filesize {
      flex-direction: row;
      justify-content: space-between;
      align-items: baseline;
      margin-top: 4px;
      padding-top: 8px;
    }

    .custom-field__value {
      font-size: 12px;
      font-weight: 600;
      color: var(--neutral);
    }

    /* ── Option B Styles ── */
    .panel-b .asset-info-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 13px;
      color: var(--neutral);
    }

    .panel-b .asset-info-bar__item {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .panel-b .asset-info-bar__icon {
      color: var(--subdued);
      flex-shrink: 0;
    }

    .panel-b .asset-info-bar__divider {
      width: 1px;
      height: 12px;
      background: var(--gray-200);
      flex-shrink: 0;
    }

    .panel-b__options {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .options-header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--gray-100);
    }

    .back-button {
      width: 32px;
      height: 32px;
      border: none;
      background: none;
      color: var(--neutral);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      padding: 0;
      transition: background 0.13s;
    }

    .back-button:hover {
      background: var(--layer1);
    }

    .options-header h2 {
      font-size: 18px;
      font-weight: 700;
      color: var(--neutral);
      margin: 0;
    }

    .options-content {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    /* Option B scrollable list */
    .platform-list-b {
      display: flex;
      flex-direction: column;
      gap: 6px;
      max-height: 290px;
      overflow-y: auto;
      overflow-x: hidden;
      padding-right: 4px;
      padding-bottom: 60px;
    }

    .platform-list-b::-webkit-scrollbar {
      width: 8px;
    }

    .platform-list-b::-webkit-scrollbar-track {
      background: transparent;
      border-radius: 4px;
    }

    .platform-list-b::-webkit-scrollbar-thumb {
      background: var(--gray-400);
      border-radius: 4px;
    }

    .platform-list-b::-webkit-scrollbar-thumb:hover {
      background: var(--gray-500);
    }

    /* Option B Platform Rows - right-aligned logos like Option A */
    .platform-list-b .platform-row {
      border: 2px solid #E9E9E9;
      border-radius: 8px;
      overflow: hidden;
      transition: border-color 0.12s, background 0.12s;
      background: white;
      flex-shrink: 0;
      cursor: pointer;
    }

    .platform-list-b .platform-row:hover {
      background: #F8F8F8;
    }

    .platform-list-b .platform-row.selected {
      border-color: var(--neutral);
    }

    .platform-list-b .platform-row__header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 9px 12px;
      height: 60px;
      min-height: 60px;
      cursor: pointer;
      user-select: none;
    }

    .platform-list-b .platform-row__checkbox {
      width: 16px;
      height: 16px;
      border-radius: 3px;
      border: 1.5px solid #9A9A9A;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      background: white;
      transition: background 0.1s, border-color 0.1s;
    }

    .platform-list-b .platform-row__checkbox svg {
      display: none;
    }

    .platform-list-b .platform-row.selected .platform-row__checkbox {
      background: var(--neutral);
      border-color: var(--neutral);
    }

    .platform-list-b .platform-row.selected .platform-row__checkbox svg {
      display: block;
    }

    .platform-list-b .platform-row__name {
      flex: 1;
      font-size: 14px;
      font-weight: 400;
      color: var(--neutral);
    }

    .platform-list-b .platform-row__logo {
      width: 40px;
      height: 40px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      overflow: hidden;
    }

    .platform-list-b .platform-row__logo-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .platform-list-b .platform-row__options-icon {
      width: 20px;
      height: 20px;
      color: var(--subdued);
      flex-shrink: 0;
      opacity: 0;
      transition: opacity 0.13s;
      cursor: pointer;
    }

    .platform-list-b .platform-row.selected .platform-row__options-icon {
      opacity: 1;
    }

    /* ── Divider ── */
    .divider { height:1px; background:var(--gray-100); }

    /* ── Content Credentials ── */
    .content-credentials {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 20px;
    }

    .content-credentials__header {
      display: flex;
      align-items: center;
    }

    .toggle-label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      user-select: none;
    }

    .toggle-input {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-switch {
      position: relative;
      width: 26px;
      height: 16px;
      background: transparent;
      border-radius: 12px;
      transition: background 0.2s, border 0.2s;
      border: 2px solid var(--neutral);
    }

    .toggle-switch::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 8px;
      height: 8px;
      background: var(--neutral);
      border-radius: 50%;
      transition: transform 0.2s, background 0.2s;
    }

    .toggle-input:checked + .toggle-switch {
      background: var(--neutral);
      border-color: var(--neutral);
    }

    .toggle-input:checked + .toggle-switch::after {
      transform: translateX(10px);
      background: white;
    }

    .toggle-text {
      font-size: 14px;
      font-weight: 400;
      color: var(--neutral);
    }

    .content-credentials__link {
      font-size: 14px;
      color: var(--blue);
      text-decoration: none;
      margin-left: 34px;
    }

    .content-credentials__link:hover {
      text-decoration: underline;
    }

    .content-credentials__note {
      background: var(--layer1);
      border-radius: 6px;
      padding: 12px;
      font-size: 13px;
      color: var(--subdued);
    }

    .note-header {
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
      color: var(--neutral);
      margin-bottom: 4px;
    }

    .note-header svg {
      color: var(--gray-500);
    }

    .content-credentials__note p {
      margin: 0;
      line-height: 1.5;
    }

    /* ── Note box ── */
    .note-box {
      background: var(--layer1); border-radius: 8px;
      padding: 14px 16px; font-size: 14px;
      color: var(--subdued); line-height: 1.5;
    }
    .note-box-title {
      display: flex; align-items: center; gap: 8px;
      font-size: 14px; color: var(--neutral);
      font-weight: 400; margin-bottom: 8px;
    }
    .note-box ul { padding-left: 20px; }
    .note-box ul li { margin-bottom: 4px; }
    .note-box a { color: var(--blue); text-decoration: none; }
    .note-box a:hover { text-decoration: underline; }

    /* ── Button ── */
    .btn-primary {
      width: 100%; height: 36px;
      background: var(--neutral); color: #fff;
      border: none; border-radius: 60px;
      font-family: var(--font); font-size: 14px; font-weight: 700;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center; gap: 8px;
      transition: background 0.15s, opacity 0.15s;
    }
    .btn-primary:hover:not(:disabled) { background: var(--gray-800); }
    .btn-primary:focus-visible { outline: 2px solid var(--blue); outline-offset: 2px; }
    .btn-primary:disabled { opacity: 0.35; cursor: not-allowed; }
    .btn-primary.loading { background: var(--gray-500); cursor: default; pointer-events: none; }
    .btn-primary.success { background: var(--green); pointer-events: none; }
    .btn-primary.error   { background: var(--red); }

    /* Spinner */
    .spinner {
      width: 14px; height: 14px;
      border: 2px solid rgba(255,255,255,0.35);
      border-top-color: white; border-radius: 50%;
      animation: spin 0.7s linear infinite; flex-shrink: 0;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* ── Progress bar ── */
    .progress-wrap {
      display: none; flex-direction: column; gap: 6px;
    }
    .progress-wrap.visible { display: flex; }
    .progress-label {
      display: flex; justify-content: space-between;
      font-size: 12px; color: var(--subdued);
    }
    .progress-label span:last-child { color: var(--blue); font-weight: 600; }
    .progress-bar {
      width: 100%; height: 4px;
      background: var(--gray-100); border-radius: 2px; overflow: hidden;
    }
    .progress-fill {
      height: 100%; background: var(--blue); border-radius: 2px;
      transition: width 0.4s ease; width: 0%;
    }

  </style>
</head>
<body>

<div class="container">
  <!-- Option A -->
  <div class="option-wrapper">
    <div class="option-label">Option A</div>
    <div class="panel" role="dialog" aria-modal="false" aria-labelledby="panel-title-a">

  <!-- Header -->
  <div class="panel-header">
    <h2 id="panel-title">Export</h2>
    <p>We'll make sure the export is compliant to the platform you select.</p>
  </div>

  <!-- Asset info bar -->
  <div class="asset-info" role="region" aria-label="Asset information">
    <div class="info-item">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.8"/>
        <path d="M12 7v5l3 3" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
      </svg>
      <span>0:30</span>
    </div>
    <div class="divider-v" aria-hidden="true"></div>
    <div class="info-item">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="1.8"/>
      </svg>
      <span>16:9</span>
    </div>
    <div class="divider-v" aria-hidden="true"></div>
    <div class="info-item">
      <span>29.97 fps</span>
    </div>
  </div>

  <!-- Platform list -->
  <div class="platform-section">
    <div class="section-label">
      <span>Platforms</span>
      <span class="count hidden" id="platform-count" aria-live="polite"></span>
    </div>
    <div class="platform-list" id="platform-list" role="group" aria-label="Platform selection">

      <div class="platform-row" role="checkbox" aria-checked="false" tabindex="0" data-platform="roku" aria-label="Roku" aria-expanded="false">
        <div class="platform-row-header">
          <div class="platform-check" aria-hidden="true">
            <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="platform-logo">
            <img src="logos/roku.png" alt="Roku logo" />
          </div>
          <span class="platform-name">Roku</span>
          <svg class="platform-chevron" width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true">
            <path d="M2 4.5L6 8.5L10 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="platform-specs" aria-hidden="true">
          <div class="spec-row"><span class="spec-label">Format</span><span class="spec-value">MP4 (H.264)</span></div>
          <div class="spec-row"><span class="spec-label">Resolution</span><span class="spec-value">1080p</span></div>
          <div class="spec-row"><span class="spec-label">Max file size</span><span class="spec-value">42 MB / 1 GB</span></div>
        </div>
      </div>

      <div class="platform-row" role="checkbox" aria-checked="false" tabindex="0" data-platform="hulu" aria-label="Hulu" aria-expanded="false">
        <div class="platform-row-header">
          <div class="platform-check" aria-hidden="true">
            <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="platform-logo">
            <img src="logos/hulu.png" alt="Hulu logo" />
          </div>
          <span class="platform-name">Hulu</span>
          <svg class="platform-chevron" width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true">
            <path d="M2 4.5L6 8.5L10 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="platform-specs" aria-hidden="true">
          <div class="spec-row"><span class="spec-label">Format</span><span class="spec-value">MP4 (H.264)</span></div>
          <div class="spec-row"><span class="spec-label">Resolution</span><span class="spec-value">1080p</span></div>
          <div class="spec-row"><span class="spec-label">Max file size</span><span class="spec-value warning">142 MB / 200 MB</span></div>
        </div>
      </div>

      <div class="platform-row" role="checkbox" aria-checked="false" tabindex="0" data-platform="amazon" aria-label="Amazon Fire TV" aria-expanded="false">
        <div class="platform-row-header">
          <div class="platform-check" aria-hidden="true">
            <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="platform-logo">
            <img src="logos/fire.png" alt="Amazon Fire TV logo" />
          </div>
          <span class="platform-name">Amazon Fire TV</span>
          <svg class="platform-chevron" width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true">
            <path d="M2 4.5L6 8.5L10 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="platform-specs" aria-hidden="true">
          <div class="spec-row"><span class="spec-label">Format</span><span class="spec-value">MP4 (H.264)</span></div>
          <div class="spec-row"><span class="spec-label">Resolution</span><span class="spec-value">1080p</span></div>
          <div class="spec-row"><span class="spec-label">Max file size</span><span class="spec-value">500 MB / 2 GB</span></div>
        </div>
      </div>

      <div class="platform-row" role="checkbox" aria-checked="false" tabindex="0" data-platform="appletv" aria-label="Apple TV+" aria-expanded="false">
        <div class="platform-row-header">
          <div class="platform-check" aria-hidden="true">
            <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="platform-logo">
            <img src="logos/apple.png" alt="Apple TV+ logo" />
          </div>
          <span class="platform-name">Apple TV+</span>
          <svg class="platform-chevron" width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true">
            <path d="M2 4.5L6 8.5L10 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="platform-specs" aria-hidden="true">
          <div class="spec-row"><span class="spec-label">Format</span><span class="spec-value">MP4 (H.264)</span></div>
          <div class="spec-row"><span class="spec-label">Resolution</span><span class="spec-value">1080p</span></div>
          <div class="spec-row"><span class="spec-label">Max file size</span><span class="spec-value">100 MB / 1 GB</span></div>
        </div>
      </div>

      <div class="platform-row" role="checkbox" aria-checked="false" tabindex="0" data-platform="peacock" aria-label="Peacock" aria-expanded="false">
        <div class="platform-row-header">
          <div class="platform-check" aria-hidden="true">
            <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="platform-logo">
            <img src="logos/peacock.png" alt="Peacock logo" />
          </div>
          <span class="platform-name">Peacock</span>
          <svg class="platform-chevron" width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true">
            <path d="M2 4.5L6 8.5L10 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="platform-specs" aria-hidden="true">
          <div class="spec-row"><span class="spec-label">Format</span><span class="spec-value">MP4 (H.264)</span></div>
          <div class="spec-row"><span class="spec-label">Resolution</span><span class="spec-value">1080p</span></div>
          <div class="spec-row"><span class="spec-label">Max file size</span><span class="spec-value">200 MB / 1 GB</span></div>
        </div>
      </div>

      <div class="platform-row" role="checkbox" aria-checked="false" tabindex="0" data-platform="samsung" aria-label="Samsung Ads" aria-expanded="false">
        <div class="platform-row-header">
          <div class="platform-check" aria-hidden="true">
            <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="platform-logo">
            <img src="logos/samsung.png" alt="Samsung Ads logo" />
          </div>
          <span class="platform-name">Samsung Ads</span>
          <svg class="platform-chevron" width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true">
            <path d="M2 4.5L6 8.5L10 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="platform-specs" aria-hidden="true">
          <div class="spec-row"><span class="spec-label">Format</span><span class="spec-value">MP4 (H.264)</span></div>
          <div class="spec-row"><span class="spec-label">Resolution</span><span class="spec-value">1080p</span></div>
          <div class="spec-row"><span class="spec-label">Max file size</span><span class="spec-value">150 MB / 500 MB</span></div>
        </div>
      </div>

      <div class="platform-row" role="checkbox" aria-checked="false" tabindex="0" data-platform="roku-channel" aria-label="The Roku Channel" aria-expanded="false">
        <div class="platform-row-header">
          <div class="platform-check" aria-hidden="true">
            <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="platform-logo">
            <img src="logos/roku.png" alt="The Roku Channel logo" />
          </div>
          <span class="platform-name">The Roku Channel</span>
          <svg class="platform-chevron" width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true">
            <path d="M2 4.5L6 8.5L10 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="platform-specs" aria-hidden="true">
          <div class="spec-row"><span class="spec-label">Format</span><span class="spec-value">MP4 (H.264)</span></div>
          <div class="spec-row"><span class="spec-label">Resolution</span><span class="spec-value">1080p</span></div>
          <div class="spec-row"><span class="spec-label">Max file size</span><span class="spec-value">300 MB / 1 GB</span></div>
        </div>
      </div>

      <!-- Custom Platform -->
      <div class="platform-row platform-row--custom" role="checkbox" aria-checked="false" tabindex="0" data-platform="custom" aria-label="Custom" aria-expanded="false">
        <div class="platform-row-header">
          <div class="platform-check" aria-hidden="true">
            <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="platform-logo" style="background-color: #EB1000;">
            <span style="color: white; font-size: 18px; font-weight: 700; font-family: 'Adobe Clean', sans-serif;">A</span>
          </div>
          <span class="platform-name">Custom</span>
        </div>
        <div class="platform-specs platform-specs--custom" aria-hidden="true">
          <!-- Resolution -->
          <div class="custom-field">
            <label class="custom-field__label">Resolution</label>
            <select class="custom-select" id="custom-resolution">
              <option value="1080p">1080p (default)</option>
              <option value="720p">720p</option>
              <option value="4k">4K</option>
            </select>
            <div class="custom-recommended">
              <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                <circle cx="7" cy="7" r="6" stroke="#1473E6" stroke-width="1.5" fill="none"/>
                <circle cx="7" cy="7" r="2.5" fill="#1473E6"/>
              </svg>
              <span>Recommended</span>
            </div>
          </div>

          <!-- File Format -->
          <div class="custom-field">
            <label class="custom-field__label">File format</label>
            <select class="custom-select" id="custom-format">
              <option value="mp4">MP4 (H.264)</option>
              <option value="mov">MOV</option>
              <option value="webm">WebM</option>
            </select>
            <div class="custom-recommended">
              <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                <circle cx="7" cy="7" r="6" stroke="#1473E6" stroke-width="1.5" fill="none"/>
                <circle cx="7" cy="7" r="2.5" fill="#1473E6"/>
              </svg>
              <span>Recommended</span>
            </div>
          </div>

          <!-- Audio -->
          <div class="custom-field">
            <label class="custom-field__label">Audio</label>
            <select class="custom-select" id="custom-audio">
              <option value="aac">AAC-LC stereo</option>
              <option value="mp3">MP3 stereo</option>
              <option value="none">No audio</option>
            </select>
            <div class="custom-recommended">
              <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                <circle cx="7" cy="7" r="6" stroke="#1473E6" stroke-width="1.5" fill="none"/>
                <circle cx="7" cy="7" r="2.5" fill="#1473E6"/>
              </svg>
              <span>Recommended</span>
            </div>
          </div>

          <!-- File Size -->
          <div class="custom-field custom-field--filesize">
            <span class="custom-field__label">File size</span>
            <span class="custom-field__value">150 MB / 500 MB</span>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Content Credentials -->
  <div class="content-credentials">
    <div class="content-credentials__header">
      <label class="toggle-label">
        <input type="checkbox" id="content-credentials-toggle" class="toggle-input" checked>
        <span class="toggle-switch"></span>
        <span class="toggle-text">Apply Content Credentials</span>
      </label>
    </div>
    <a href="#" class="content-credentials__link">Learn more about Content Credentials</a>
    <!-- Note section removed temporarily - may bring back later
    <div class="content-credentials__note">
      <div class="note-header">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true">
          <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
          <path d="M8 7v4M8 5h.01" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        <span>Note</span>
      </div>
      <p>Files will be packaged in a zip folder.</p>
    </div>
    -->
  </div>

  <!-- Progress bar -->
  <div class="progress-wrap" id="progress-wrap" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Export progress">
    <div class="progress-label">
      <span id="progress-text">Exporting…</span>
      <span id="progress-pct">0%</span>
    </div>
    <div class="progress-bar">
      <div class="progress-fill" id="progress-fill"></div>
    </div>
  </div>


  <!-- CTA button -->
  <button class="btn-primary" id="export-btn" disabled aria-disabled="true">
    <span id="btn-label">Download</span>
  </button>

</div>
  </div>

  <!-- Option B -->
  <div class="option-wrapper">
    <div class="option-label">Option B</div>
    <div class="panel panel-b" id="panel-b" role="dialog" aria-modal="false" aria-labelledby="panel-title-b">

      <!-- Main Panel State -->
      <div class="panel-b__main" id="panel-b-main">
        <div class="panel-header">
          <h2 id="panel-title-b">Export</h2>
          <p>We'll make sure the export is compliant to the platform you select.</p>
        </div>

        <!-- Asset Info -->
        <div class="asset-info-bar">
          <div class="asset-info-bar__item">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="asset-info-bar__icon"><circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/><path d="M8 4v4l3 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
            <span>0:30</span>
          </div>
          <div class="asset-info-bar__divider"></div>
          <div class="asset-info-bar__item">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="asset-info-bar__icon"><rect x="2" y="3" width="12" height="10" rx="1" stroke="currentColor" stroke-width="1.5"/></svg>
            <span>16:9</span>
          </div>
          <div class="asset-info-bar__divider"></div>
          <div class="asset-info-bar__item">
            <span>29.97 fps</span>
          </div>
        </div>

        <!-- Platform List -->
        <div class="platform-section">
          <div class="section-label">
            <span>Platforms</span>
            <span id="platform-count-b" class="count hidden">0 selected</span>
          </div>
          <div class="platform-list platform-list-b" id="platform-list-b">
            <div class="platform-row" data-platform-b="roku">
              <div class="platform-row__header">
                <div class="platform-row__checkbox">
                  <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
                <span class="platform-row__name">Roku</span>
                <svg class="platform-row__options-icon" width="18" height="18" viewBox="0 0 18 18" fill="none">
                  <circle cx="4" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="9" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="14" cy="9" r="1.5" fill="currentColor"/>
                </svg>
                <div class="platform-row__logo">
                  <img src="logos/roku.png" alt="Roku logo" class="platform-row__logo-image" />
                </div>
              </div>
            </div>

            <div class="platform-row" data-platform-b="hulu">
              <div class="platform-row__header">
                <div class="platform-row__checkbox">
                  <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
                <span class="platform-row__name">Hulu</span>
                <svg class="platform-row__options-icon" width="18" height="18" viewBox="0 0 18 18" fill="none">
                  <circle cx="4" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="9" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="14" cy="9" r="1.5" fill="currentColor"/>
                </svg>
                <div class="platform-row__logo">
                  <img src="logos/hulu.png" alt="Hulu logo" class="platform-row__logo-image" />
                </div>
              </div>
            </div>

            <div class="platform-row" data-platform-b="amazon">
              <div class="platform-row__header">
                <div class="platform-row__checkbox">
                  <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
                <span class="platform-row__name">Amazon Fire TV</span>
                <svg class="platform-row__options-icon" width="18" height="18" viewBox="0 0 18 18" fill="none">
                  <circle cx="4" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="9" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="14" cy="9" r="1.5" fill="currentColor"/>
                </svg>
                <div class="platform-row__logo">
                  <img src="logos/fire.png" alt="Amazon Fire TV logo" class="platform-row__logo-image" />
                </div>
              </div>
            </div>

            <div class="platform-row" data-platform-b="appletv">
              <div class="platform-row__header">
                <div class="platform-row__checkbox">
                  <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
                <span class="platform-row__name">Apple TV+</span>
                <svg class="platform-row__options-icon" width="18" height="18" viewBox="0 0 18 18" fill="none">
                  <circle cx="4" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="9" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="14" cy="9" r="1.5" fill="currentColor"/>
                </svg>
                <div class="platform-row__logo">
                  <img src="logos/apple.png" alt="Apple TV+ logo" class="platform-row__logo-image" />
                </div>
              </div>
            </div>

            <div class="platform-row" data-platform-b="peacock">
              <div class="platform-row__header">
                <div class="platform-row__checkbox">
                  <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
                <span class="platform-row__name">Peacock</span>
                <svg class="platform-row__options-icon" width="18" height="18" viewBox="0 0 18 18" fill="none">
                  <circle cx="4" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="9" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="14" cy="9" r="1.5" fill="currentColor"/>
                </svg>
                <div class="platform-row__logo">
                  <img src="logos/peacock.png" alt="Peacock logo" class="platform-row__logo-image" />
                </div>
              </div>
            </div>

            <div class="platform-row" data-platform-b="samsung">
              <div class="platform-row__header">
                <div class="platform-row__checkbox">
                  <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
                <span class="platform-row__name">Samsung Ads</span>
                <svg class="platform-row__options-icon" width="18" height="18" viewBox="0 0 18 18" fill="none">
                  <circle cx="4" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="9" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="14" cy="9" r="1.5" fill="currentColor"/>
                </svg>
                <div class="platform-row__logo">
                  <img src="logos/samsung.png" alt="Samsung Ads logo" class="platform-row__logo-image" />
                </div>
              </div>
            </div>

            <div class="platform-row" data-platform-b="roku-channel">
              <div class="platform-row__header">
                <div class="platform-row__checkbox">
                  <svg width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M2 5l2.5 2.5L8 2.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </div>
                <span class="platform-row__name">The Roku Channel</span>
                <svg class="platform-row__options-icon" width="18" height="18" viewBox="0 0 18 18" fill="none">
                  <circle cx="4" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="9" cy="9" r="1.5" fill="currentColor"/>
                  <circle cx="14" cy="9" r="1.5" fill="currentColor"/>
                </svg>
                <div class="platform-row__logo">
                  <img src="logos/roku.png" alt="The Roku Channel logo" class="platform-row__logo-image" />
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Content Credentials -->
        <div class="content-credentials">
          <div class="content-credentials__header">
            <label class="toggle-label">
              <input type="checkbox" id="content-credentials-toggle-b" class="toggle-input" checked>
              <span class="toggle-switch"></span>
              <span class="toggle-text">Apply Content Credentials</span>
            </label>
          </div>
          <a href="#" class="content-credentials__link">Learn more about Content Credentials</a>
        </div>

        <!-- Export Button -->
        <button class="btn-primary" id="export-btn-b" disabled aria-disabled="true">
          <span id="btn-label-b">Download</span>
        </button>
      </div>

      <!-- Options Panel State (hidden by default) -->
      <div class="panel-b__options hidden" id="panel-b-options">
        <div class="options-header">
          <button class="back-button" id="back-button-b" aria-label="Back to platform list">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M12 4L6 10L12 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <h2 id="options-title-b">Platform Name</h2>
        </div>

        <div class="options-content" id="options-content-b">
          <!-- Options content will be dynamically populated -->
        </div>
      </div>

    </div>
  </div>
</div>

<script>
  // ── State ──
  const state = {
    selected: new Set(),
    phase: 'idle',
  };

  const platformNames = {
    roku: 'Roku', hulu: 'Hulu', amazon: 'Amazon Fire TV',
    appletv: 'Apple TV+', peacock: 'Peacock',
    samsung: 'Samsung Ads', 'roku-channel': 'The Roku Channel',
    custom: 'Custom',
  };

  // ── DOM refs ──
  const exportBtn     = document.getElementById('export-btn');
  const btnLabel      = document.getElementById('btn-label');
  const platformCount = document.getElementById('platform-count');
  const fileSizeLabel = document.getElementById('file-size-label');
  const progressWrap  = document.getElementById('progress-wrap');
  const progressFill  = document.getElementById('progress-fill');
  const progressPct   = document.getElementById('progress-pct');
  const progressText  = document.getElementById('progress-text');

  // ── Update UI ──
  function update() {
    const count = state.selected.size;

    // Count badge
    if (count > 0) {
      platformCount.textContent = `${count} selected`;
      platformCount.classList.remove('hidden');
    } else {
      platformCount.classList.add('hidden');
    }

    // Note single vs zip (removed)

    // Button label
    if (state.phase === 'idle') {
      if (count === 0) btnLabel.textContent = 'Download';
      else if (count === 1) btnLabel.textContent = 'Download (1 platform)';
      else btnLabel.textContent = `Download (${count} platforms)`;
    }

    const canExport = count > 0 && state.phase === 'idle';
    exportBtn.disabled = !canExport;
    exportBtn.setAttribute('aria-disabled', String(!canExport));
  }

  // ── Platform row interaction ──
  document.querySelectorAll('[data-platform]').forEach(row => {
    const checkbox = row.querySelector('.platform-check');
    const chevron  = row.querySelector('.platform-chevron');

    function handleClick(e) {
      const p = row.dataset.platform;
      const isSelected = state.selected.has(p);
      const isCustom = p === 'custom';
      const specs = row.querySelector('.platform-specs');

      // Check if checkbox was clicked
      const clickedCheckbox = e.target.closest('.platform-check') || e.target.closest('.platform-logo');

      if (clickedCheckbox) {
        // Clicking checkbox always toggles selection
        if (isSelected) {
          state.selected.delete(p);
          row.classList.remove('selected', 'open');
          row.setAttribute('aria-checked', 'false');
          row.setAttribute('aria-expanded', 'false');
          if (specs) specs.setAttribute('aria-hidden', 'true');
        } else {
          state.selected.add(p);
          row.classList.add('selected');
          row.setAttribute('aria-checked', 'true');
          // Custom platform always opens when selected
          if (isCustom) {
            row.classList.add('open');
            row.setAttribute('aria-expanded', 'true');
            if (specs) specs.setAttribute('aria-hidden', 'false');
          } else {
            row.classList.remove('open');
            row.setAttribute('aria-expanded', 'false');
            if (specs) specs.setAttribute('aria-hidden', 'true');
          }
        }
      } else {
        // Clicking elsewhere on selected row toggles expand
        if (isSelected) {
          // For custom platform, clicking row body does nothing (must use checkbox to deselect)
          if (isCustom) {
            // Do nothing - custom platform stays open when selected
          } else {
            // Regular platforms toggle expand
            const isOpen = row.classList.contains('open');
            if (isOpen) {
              row.classList.remove('open');
              row.setAttribute('aria-expanded', 'false');
              if (specs) specs.setAttribute('aria-hidden', 'true');
            } else {
              row.classList.add('open');
              row.setAttribute('aria-expanded', 'true');
              if (specs) specs.setAttribute('aria-hidden', 'false');
            }
          }
        } else {
          // Clicking unselected row selects it
          state.selected.add(p);
          row.classList.add('selected');
          row.setAttribute('aria-checked', 'true');
          // Custom platform always opens when selected
          if (isCustom) {
            row.classList.add('open');
            row.setAttribute('aria-expanded', 'true');
            if (specs) specs.setAttribute('aria-hidden', 'false');
          } else {
            row.setAttribute('aria-expanded', 'false');
            if (specs) specs.setAttribute('aria-hidden', 'true');
          }
        }
      }
      update();
    }

    row.addEventListener('click', handleClick);
    row.addEventListener('keydown', e => {
      if (e.key === ' ' || e.key === 'Enter') { e.preventDefault(); handleClick(e); }
    });
  });

  // ── Export flow ──
  function startExport() {
    if (state.phase !== 'idle' || state.selected.size === 0) return;
    state.phase = 'loading';

    exportBtn.classList.add('loading');
    exportBtn.disabled = true;
    exportBtn.setAttribute('aria-disabled', 'true');
    btnLabel.innerHTML = '<div class="spinner"></div><span>Exporting…</span>';

    progressWrap.classList.add('visible');
    let pct = 0;
    const platforms = [...state.selected];
    const interval = setInterval(() => {
      pct += Math.random() * 18 + 4;
      if (pct > 97) pct = 97;
      progressFill.style.width = pct + '%';
      progressPct.textContent = Math.round(pct) + '%';
      progressWrap.setAttribute('aria-valuenow', Math.round(pct));
      const idx = Math.floor((pct / 100) * platforms.length);
      const name = platformNames[platforms[Math.min(idx, platforms.length - 1)]];
      progressText.textContent = `Exporting for ${name}…`;
    }, 300);

    setTimeout(() => {
      clearInterval(interval);
      progressFill.style.width = '100%';
      progressPct.textContent = '100%';
      setTimeout(() => {
        progressWrap.classList.remove('visible');
        exportBtn.classList.remove('loading');
        const success = Math.random() > 0.1;
        if (success) {
          state.phase = 'success';
          exportBtn.classList.add('success');
          exportBtn.disabled = true;
          btnLabel.innerHTML = `
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M5 12l5 5L20 7" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Export complete</span>`;
          // External toast will show: "Adobe Sleek audio added" (or export success message)
        } else {
          state.phase = 'error';
          exportBtn.classList.add('error');
          exportBtn.disabled = false;
          exportBtn.setAttribute('aria-disabled', 'false');
          btnLabel.innerHTML = `
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <circle cx="12" cy="12" r="10" stroke="white" stroke-width="2"/>
              <path d="M12 9v4M12 16h.01" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <span>Export failed — Try again</span>`;
          // External toast will show error message
        }
      }, 400);
    }, 3200);
  }

  exportBtn.addEventListener('click', () => {
    if (state.phase === 'error') { resetToIdle(); startExport(); }
    else startExport();
  });

  function resetToIdle() {
    state.phase = 'idle';
    exportBtn.classList.remove('success', 'error', 'loading');
    progressWrap.classList.remove('visible');
    progressFill.style.width = '0%';
    update();
  }

  // ── Init ──
  update();

  // ═══════════════════════════════════════════════
  // OPTION B - Separate state and logic
  // ═══════════════════════════════════════════════

  const stateB = {
    selected: new Set(),
    phase: 'idle',
  };

  const exportBtnB = document.getElementById('export-btn-b');
  const btnLabelB = document.getElementById('btn-label-b');
  const platformCountB = document.getElementById('platform-count-b');

  function updateB() {
    const count = stateB.selected.size;

    // Count badge
    if (count > 0) {
      platformCountB.textContent = `${count} selected`;
      platformCountB.classList.remove('hidden');
    } else {
      platformCountB.classList.add('hidden');
    }

    // Button label
    if (stateB.phase === 'idle') {
      if (count === 0) btnLabelB.textContent = 'Download';
      else if (count === 1) btnLabelB.textContent = 'Download (1 platform)';
      else btnLabelB.textContent = `Download (${count} platforms)`;
    }

    const canExport = count > 0 && stateB.phase === 'idle';
    exportBtnB.disabled = !canExport;
    exportBtnB.setAttribute('aria-disabled', String(!canExport));
  }

  // Platform row interaction for Option B
  document.querySelectorAll('[data-platform-b]').forEach(row => {
    const platformId = row.dataset.platformB;

    function handleClickB(e) {
      const isSelected = stateB.selected.has(platformId);

      // Check if options icon was clicked
      const clickedOptions = e.target.closest('.platform-row__options-icon');

      // Check if checkbox was clicked (NOT logo anymore - logo should select)
      const clickedCheckbox = e.target.closest('.platform-row__checkbox');

      console.log('Option B click:', platformId, 'isSelected:', isSelected, 'clickedCheckbox:', !!clickedCheckbox, 'clickedOptions:', !!clickedOptions);

      if (clickedOptions && isSelected) {
        // Options icon clicked - navigate to options panel (TODO: implement later)
        console.log('Options clicked for:', platformId);
        return;
      }

      if (clickedCheckbox) {
        // Clicking checkbox always toggles selection
        if (isSelected) {
          console.log('Deselecting:', platformId);
          stateB.selected.delete(platformId);
          row.classList.remove('selected');
        } else {
          console.log('Selecting via checkbox:', platformId);
          stateB.selected.add(platformId);
          row.classList.add('selected');
        }
      } else {
        // Clicking row body (anywhere except checkbox and options icon)
        if (!isSelected) {
          console.log('Selecting via row:', platformId);
          stateB.selected.add(platformId);
          row.classList.add('selected');
        }
        // If already selected and clicked row (not checkbox), do nothing
      }

      updateB();
    }

    row.addEventListener('click', handleClickB);
  });

  // Init Option B
  updateB();
</script>
</body>
</html>
